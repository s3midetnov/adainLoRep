\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{preamble}[2020/07/26 Preamble]

\RequirePackage[no-math]{fontspec} 	
\RequirePackage[russian]{babel}
\RequirePackage{microtype}
\RequirePackage[margin=1in]{geometry}
\RequirePackage{blindtext}             					
\RequirePackage{comment}        
\RequirePackage[dvipsnames]{xcolor}             
\RequirePackage{hyphenat}						
\RequirePackage[shortlabels]{enumitem}
\RequirePackage{float}
\RequirePackage{footmisc}							
\RequirePackage{setspace}        
\RequirePackage{imakeidx}
\RequirePackage{hyperref}
\RequirePackage{graphicx}
\RequirePackage{caption}
\RequirePackage{subcaption}
\RequirePackage{transparent}
\RequirePackage[nottoc]{tocbibind}                  
\RequirePackage{import}                                                 
\RequirePackage{imakeidx}  
\RequirePackage{tocloft} 
\RequirePackage{amsthm}
\RequirePackage{amsmath}
\RequirePackage{mathtools}         
\RequirePackage{tensor} 		
\RequirePackage{stackrel}         
\RequirePackage{centernot}   
\RequirePackage{tikz-cd} 
\RequirePackage{extarrows}
\RequirePackage{fancyhdr}
\RequirePackage{xpatch}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclareOption{no-chapters}{
	\renewcommand{\thesection}{\arabic{section}}	
}
\DeclareOption{fix-interword-spacing}{
	\xapptocmd{\selectfont}
	{\spaceskip=\fontdimen2\font plus \fontdimen3\font\relax}
	{}{}
}
\DeclareOption{fix-math-spacing}{
	\thinmuskip=1\thinmuskip
	\medmuskip=1\medmuskip
	\thickmuskip=1\thickmuskip
}
\DeclareOption{CMU-calligraphic}{
	\SetMathAlphabet{\mathcal}{normal}{OMS}{cmsy}{m}{n}
}
\DeclareOption{roman-sections}{
	\renewcommand\thesection{\Roman{section}}
}
\DeclareOption{alphabetic-subsections}{
	\renewcommand\thesubsection{\thesection.\Alph{subsection}}
}
\DeclareOption{slanted-inequalities}{
	\newcommand{\originalle}{\le}
	\newcommand{\originalge}{\ge}
	\renewcommand{\le}{\leqslant}
	\renewcommand{\ge}{\geqslant}
	\renewcommand{\leq}{\leqslant}
	\renewcommand{\geq}{\geqslant}
}
\DeclareOption*{\PackageWarning{preamble}{Unknown ‘\CurrentOption’}}
\ProcessOptions\relax

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setmainfont{STIX Two Text}
\let\arrowvert\undefined
\RequirePackage[stix2]{newtxmath}
\let\openbox\undefined
\DeclareSymbolFont{operators}{OT1}{stix2}{m}{n}
\SetSymbolFont{operators}{bold}{OT1}{stix2}{b}{n}

\pagestyle{fancy}
\fancyhead[R]{\textit{\nouppercase{\rightmark}}}
\fancyhead[L]{}
\setlength{\headheight}{15pt}
				
\hypersetup{									
	colorlinks=true,
	linkcolor=blue!66!black,
	citecolor=red!66!black,
	urlcolor=green!33!black
}

\setlength\parindent{1.5em}             
\renewcommand{\baselinestretch}{1.1}   
 
\graphicspath{{images/}}

\counterwithin{equation}{section}

%\setlength{\cftsecindent}{1em} 
%\setlength{\cftsecnumwidth}{1.75em} 
%\setlength{\cftsubsecindent}{2.75em} 
%\setlength{\cftsubsecnumwidth}{2.75em} 
%\setlength{\cftbeforesecskip}{1em}

\makeindex[columns=2, title=Индекс, intoc]

\def\th@definition{
	\thm@notefont{}	
	\normalfont  
}

\theoremstyle{definition}

\newtheorem{theorem}{Теорема}[section]
\newtheorem{corollary}[theorem]{Следствие}
\newtheorem{lemma}[theorem]{Лемма}
\newtheorem{proposition}[theorem]{Утверждение}
\newtheorem{example}{Пример}[section]
\newtheorem{examples}[example]{Примеры}
\newtheorem{problem}{Задача}[section]

\newtheorem*{definition}{Определение}
\newtheorem*{remark}{Замечание}
\newtheorem*{remarks}{Замечания}
\newtheorem*{exercise}{Упражнение}
\newtheorem*{exercises}{Упражнения}
\newtheorem*{notation}{Обозначение}
\newtheorem*{convention}{Соглашение}

\newtheorem{*theorem}[theorem]{*Теорема}
\newtheorem{*corollary}[theorem]{*Следствие}
\newtheorem{*lemma}[theorem]{*Лемма}
\newtheorem{*proposition}[theorem]{*Утверждение}
\newtheorem{*example}[example]{*Пример}
\newtheorem{*examples}[example]{*Примеры}
\newtheorem*{*definition}{*Определение}

\newtheorem*{theorem*}{Теорема}
\newtheorem*{corollary*}{Следствие}
\newtheorem*{lemma*}{Лемма}
\newtheorem*{proposition*}{Утверждение}
\newtheorem*{example*}{Пример}
\newtheorem*{examples*}{Примеры}

\renewcommand{\qedsymbol}{$ \blacksquare $}

\usetikzlibrary{babel}
\tikzcdset{arrow style=tikz}
\tikzset{>=Stealth}

\newcommand{\wt}[1]{\widetilde{#1}}
\newcommand{\wh}[1]{\widehat{#1}}

\let\olda\a
\renewcommand{\a}{\alpha}				
\let\oldb\b				
\renewcommand{\b}{\beta}								
\newcommand{\g}{\gamma}		
\let\oldG\G			
\renewcommand{\G}{\Gamma}									
\newcommand{\de}{\delta}					
\newcommand{\De}{\Delta}
%\newcommand{\eps}{\varepsilon}
\newcommand{\e}{\epsilon}
%\newcommand{\z}{\zeta}	
\let\oldth\th
\renewcommand{\th}{\theta}
%\renewcommand{\k}{\kappa}
\let\oldl\l
\renewcommand{\l}{\lambda}
\let\oldL\L
\renewcommand{\L}{\Lambda}
%\renewcommand{\r}{\rho}
\newcommand{\s}{\sigma}
\newcommand{\CHOM}{\text{\textbf{c}Hom}}
\newcommand{\ups}{\upsilon}

%\let\pphi\phi
%\newcommand\f{\pphi}
%\renewcommand{\phi}{\varphi}

%\renewcommand{\o}{\omega}
%\renewcommand{\O}{\Omega}			
													
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}			
\newcommand{\Q}{\mathbb{Q}}		
\newcommand{\R}{\mathbb{R}}	
\let\oldC\C
\renewcommand{\C}{\mathbb{C}} 				
\newcommand{\F}{\mathbb{F}}	
 
\let\oldAA\AA
\renewcommand{\AA}{\mathbb{A}}				
\newcommand{\DD}{\mathbb{D}} 						
\newcommand{\EE}{\mathbb{E}} 			
\newcommand{\HH}{\mathbb{H}}					
\newcommand{\KK}{\mathbb{K}} 					
\newcommand{\OO}{\mathbb{O}} 		
\newcommand{\PP}{\mathbb{P}}			
\let\oldSS\SS		
\renewcommand{\SS}{\mathbb{S}}						
\newcommand{\TT}{\mathbb{T}} 			

\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}
			
\newcommand{\rD}{\mathrm{D}}
\newcommand{\rK}{\mathrm{K}}			
\newcommand{\rP}{\mathrm{P}}
\newcommand{\rT}{\mathrm{T}}			

\newcommand{\fA}{\mathfrak{A}}
\newcommand{\fB}{\mathfrak{B}}
\newcommand{\fM}{\mathfrak{M}}
\newcommand{\fL}{\mathfrak{L}}
\newcommand{\fX}{\mathfrak{X}}

\newcommand{\fm}{\mathfrak{m}}
\newcommand{\fp}{\mathfrak{p}}

\newcommand{\xra}{\xrightarrow}
\newcommand{\Lra}{\Longrightarrow}
\newcommand{\Llra}{\Longleftrightarrow}
\newcommand{\eimplies}{\,\Lra\,}

\newcommand{\elemvec}[1]{\mathbf{#1}}

\let\oldd\d
\renewcommand{\d}{\mathrm{d}} 
\newcommand{\dd}{\,\mathrm{d}}

\newcommand{\bcol}[2]{\begin{pmatrix} #1 \\ #2 \end{pmatrix}}
\newcommand{\tcol}[3]{\begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}}
\newcommand{\fcol}[4]{\begin{pmatrix} #1 \\ #2 \\ #3 \\ #4 \end{pmatrix}}
 
\newcommand{\enewline}{
	$ $ \newline
	\mbox{}
	\vspace*{-\parsep}
	\vspace*{-\baselineskip}
}

\newcommand{\Pos}{\mathrm{Pos}}
\renewcommand{\Form}{\mathrm{Form}}
\newcommand{\Prop}{\mathrm{Prop}}
\newcommand{\Sent}{\mathrm{Sent}}
\newcommand{\Pred}{\mathrm{Pred}}
\newcommand{\Func}{\mathrm{Func}}
\newcommand{\Const}{\mathrm{Const}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Term}{\mathrm{Term}}
\newcommand{\Mod}{\mathrm{Mod}}
\newcommand{\Th}{\mathrm{Th}}

\newcommand{\RP}{\R\PP}
\newcommand{\CP}{\C\PP}

\newcommand{\const}{\mathrm{const}}				
\newcommand{\tle}{\trianglelefteq} 
\newcommand{\tl}{\triangleleft}				

\newcommand{\op}{\mathrm{op}}				
\newcommand{\cat}[1]{\textbf{#1}}			
\newcommand{\Gr}{\cat{Gr}}					
\newcommand{\Ab}{\cat{Ab}}					
\newcommand{\Set}{\cat{Set}}				
\newcommand{\set}{\cat{set}}				
\newcommand{\setb}{\cat{set}_\bullet}	
\newcommand{\Rel}{\cat{Rel}}				
\newcommand{\Vect}{\cat{Vect}}				
\newcommand{\vect}{\cat{vect}}				
\newcommand{\Ring}{\cat{Ring}}				
\newcommand{\ComRing}{\cat{ComRing}}		
\renewcommand{\Top}{\cat{Top}}	
\newcommand{\Poset}{\cat{Poset}}			
\newcommand{\Metr}{\cat{Metr}}				
\newcommand{\Inj}{\cat{Inj}}			
\newcommand{\Surj}{\cat{Surj}}			
\newcommand{\Bij}{\cat{Bij}}				
\newcommand{\Pow}{\cat{Pow}}				
\newcommand{\Mon}{\cat{Mon}}				
\newcommand{\FinGr}{\cat{FinGr}}		

\newcommand{\grad}{\operatorname{grad}}

\let\intt\int
\renewcommand{\int}{\intt\limits}
\let\oointctrclockwise\ointctrclockwise
\renewcommand{\ointctrclockwise}{\oointctrclockwise\limits}

\let\cl\overline	
\newcommand{\Cl}{\operatorname{Cl}}							
\newcommand{\Int}{\operatorname{Int}}					
\newcommand{\pr}{\operatorname{pr}}							
\renewcommand{\Pr}{\operatorname{Pr}}					
\newcommand{\conv}{\operatorname{conv}}						
\newcommand{\diam}{\operatorname{diam}}					
\newcommand{\dist}{\operatorname{dist}}				
\newcommand{\Lin}{\operatorname{Lin}}				

\newcommand{\var}{\operatorname{var}}				
\newcommand{\Epi}{\operatorname{Epi}}				
\newcommand*{\esssup}{\operatorname{ess\,sup}}		
\newcommand*{\essinf}{\operatorname{ess\,inf}}		
\newcommand{\supp}{\operatorname{supp}}		
\newcommand{\BV}{\operatorname{BV}}			
\newcommand{\Lip}{\operatorname{Lip}}			
\renewcommand{\div}{\operatorname{div}}				
\newcommand{\loc}{\operatorname{loc}}			
\newcommand{\Diff}{\operatorname{Diff}}		

\let\conj\overline

\newcommand{\tr}{\operatorname{tr}}						
\newcommand{\Ord}{\operatorname{Ord}}				
\newcommand{\diag}{\operatorname{diag}}				
\newcommand{\Span}{\operatorname{span}}				
\DeclareMathOperator{\id}{id}				
\newcommand{\Char}{\operatorname{char}}					
\newcommand{\GL}{\operatorname{GL}}							
\newcommand{\SL}{\operatorname{SL}}						
\newcommand{\cf}{\operatorname{cf}}						
\newcommand{\reg}{\operatorname{reg}}				
\newcommand{\Hom}{\operatorname{Hom}}					
\newcommand{\Mor}{\operatorname{Mor}}					
\newcommand{\Aut}{\operatorname{Aut}}						
\newcommand{\End}{\operatorname{End}}						
\newcommand{\ind}{\operatorname{ind}}						
\newcommand{\Ind}{\operatorname{Ind}}					
\newcommand{\res}{\operatorname{res}}			
\newcommand{\Bil}{\operatorname{Bil}}			
\newcommand{\Sym}{\operatorname{Sym}}			
\newcommand{\Alt}{\operatorname{Alt}}			
\newcommand{\inv}{\operatorname{inv}}						
\newcommand{\rank}{\operatorname{rank}}							
\newcommand{\Ker}{\operatorname{Ker}}					
\newcommand{\sgn}{\operatorname{sgn}}					
\newcommand{\Map}{\operatorname{Map}}				
\newcommand{\ev}{\operatorname{ev}}						
\newcommand{\Gal}{\operatorname{Gal}}					
\newcommand{\Spec}{\operatorname{Spec}}						
\newcommand{\Max}{\operatorname{Max}}						
\newcommand{\Orb}{\operatorname{Orb}}						
\newcommand{\Der}{\operatorname{Der}}					
\newcommand{\card}{\operatorname{card}}	
				
\renewcommand{\Re}{\operatorname{Re}}	
\renewcommand{\Im}{\operatorname{Im}}			

\DeclarePairedDelimiter\abs{\lvert}{\rvert}	
\DeclarePairedDelimiter\norm{\lVert}{\rVert}	
\DeclarePairedDelimiter\ab{\langle}{\rangle} 	
\DeclarePairedDelimiter\ip{\langle}{\rangle} 
\DeclarePairedDelimiter\gen{\langle}{\rangle}
\DeclarePairedDelimiter\parens{\lparen}{\rparen}

\newcommand{\Ob}{\operatorname{Ob}}		
\newcommand{\dom}{\operatorname{dom}}		
\newcommand{\cod}{\operatorname{cod}}	
\newcommand{\Nat}{\operatorname{Nat}}		
\newcommand{\Eq}{\operatorname{Eq}}		
\newcommand{\Coeq}{\operatorname{Coeq}}		
\newcommand{\Sk}{\operatorname{Sk}}		
\newcommand{\Rng}{\operatorname{Rng}}		
\newcommand{\Coker}{\operatorname{Coker}}
\newcommand{\colim}{\operatorname{colim}}

\renewcommand{\emptyset}{\varnothing}

\allowdisplaybreaks

\newcommand\m[1]{\mkern#1mu}

\newcommand{\ov}{\overline}

\usepackage{letltxmacro}
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand*{\sqrt}[2][\ ]{\oldsqrt[\uproot{2}\leftroot{2}#1]{#2}}

% 25.07.2020 upd ------------------------

\newcommand{\Cont}{\operatorname{cont}}
\newcommand{\Frac}{\operatorname{Frac}}
\newcommand{\lcm}{\operatorname{lcm}}

\newcommand{\bij}{\longleftrightarrow}
\newcommand{\sto}{\twoheadrightarrow}
\newcommand{\ito}{\hookrightarrow}

\DeclareMathOperator{\range}{range}
\DeclareMathOperator{\Inf}{Inf}
\DeclareMathOperator{\ord}{ord}

\newcommand{\fC}{\mathfrak C}

\newcommand{\Tr}{\operatorname{Tr}}
\newcommand{\Stab}{\operatorname{Stab}}

\newcommand{\wk}{\operatorname{wk}}
\newcommand{\ext}{\operatorname{ext}}
\newcommand{\clconv}{\operatorname{\overline{conv}}}

\newcommand{\whh}[1]{\widehat{\widehat{{#1}}}}

\makeatletter
\renewcommand*{\coloneqq}{
	\mathrel{\rlap{%
			\raisebox{0.27ex}{$\m@th\cdot$}}%
		\raisebox{-0.3ex}{$\m@th\cdot$}}%
	=}
\makeatother

% 26.07.2020 upd ------------------------

\newcommand{\PSL}{\operatorname{PSL}}

% 29.07.2020 upd ------------------------

\newcommand{\Cent}{\operatorname{Cent}}
\newcommand{\fV}{\mathfrak{V}}
\newcommand{\sign}{\operatorname{sign}}
\newcommand{\fI}{\mathfrak{I}}
\newcommand{\Isom}{\operatorname{Isom}}
\newcommand{\Mob}{\operatorname{Mob}}
\newcommand{\Fix}{\operatorname{Fix}}
\newcommand{\Gl}{\operatorname{Gl}}

% 29.08.2020 upd ------------------------

\newcommand{\Card}{\operatorname{Card}}	
\newcommand{\adj}{\operatorname{adj}}
\newcommand{\fin}{\operatorname{fin}}
\newcommand{\Sur}{\operatorname{Sur}}
\newcommand{\Left}{\operatorname{left}}
\newcommand{\Right}{\operatorname{right}}
\newcommand{\Min}{\operatorname{Min}}
\newcommand{\IS}{\operatorname{IS}}
\DeclareMathOperator{\Subf}{Subf}
\DeclareMathOperator{\arity}{arity}
\DeclareMathOperator{\fsp}{Fin-Spec}

\newtheorem*{hypothesis}{Гипотеза}